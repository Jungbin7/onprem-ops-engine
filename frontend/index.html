<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OpsEngine Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <div class="logo">
    <div class="logo-icon">âš¡</div>
    OpsEngine
  </div>
  <div class="header-center">E-Commerce Resilience Platform Â· k3s on-premise</div>
  <div class="header-status">
    <div class="status-dot" id="status-dot"></div>
    <span id="api-status-text">ì—°ê²° ì¤‘...</span>
  </div>
</header>

<nav>
  <button class="tab active" onclick="showTab('dashboard')">ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
  <button class="tab" onclick="showTab('products')">ğŸ›ï¸ ìƒí’ˆ / ì£¼ë¬¸</button>
  <button class="tab" onclick="showTab('history')">ğŸ“‹ ì£¼ë¬¸ ë‚´ì—­</button>
  <button class="tab" onclick="showTab('infra')">ğŸ–¥ï¸ ì¸í”„ë¼</button>
</nav>

<main>
  <!-- API ì£¼ì†Œ ì„¤ì • -->
  <div class="api-config">
    <span class="config-label">API ì£¼ì†Œ</span>
    <input id="api-host-input" type="text" value="http://192.168.174.20:30080" />
    <button class="btn btn-outline" onclick="updateApiHost()">ì ìš©</button>
    <a href="#" id="swagger-link" onclick="openSwagger()" class="btn btn-outline">ğŸ“„ Swagger UI</a>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• DASHBOARD â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="page-dashboard" class="page active">
    <div class="metric-grid">
      <div class="metric-card">
        <div class="metric-icon">ğŸ“¦</div>
        <div class="metric-label">ì´ ì£¼ë¬¸ ìˆ˜</div>
        <div class="metric-value" id="m-orders">â€”</div>
        <div class="metric-sub">PostgreSQL ì €ì¥</div>
      </div>
      <div class="metric-card">
        <div class="metric-icon">ğŸ’°</div>
        <div class="metric-label">ì´ ë§¤ì¶œ</div>
        <div class="metric-value" id="m-revenue" style="font-size:1.4rem">â€”</div>
        <div class="metric-sub">ëˆ„ì  í•©ê³„</div>
      </div>
      <div class="metric-card">
        <div class="metric-icon">ğŸ‘ï¸</div>
        <div class="metric-label">ìƒí’ˆ ì¡°íšŒìˆ˜</div>
        <div class="metric-value" id="m-views">â€”</div>
        <div class="metric-sub">Redis ì¹´ìš´í„°</div>
      </div>
      <div class="metric-card">
        <div class="metric-icon">ğŸ—„ï¸</div>
        <div class="metric-label">PostgreSQL</div>
        <div class="metric-value" id="m-pg" style="font-size:1.1rem">â€”</div>
        <div class="metric-sub" id="m-redis-status">Redis í™•ì¸ ì¤‘...</div>
      </div>
    </div>

    <div class="section">
      <div class="section-header">
        <div class="section-title">ìµœê·¼ ì£¼ë¬¸ (ì‹¤ì‹œê°„)</div>
        <div style="display:flex;gap:0.5rem">
          <span id="auto-refresh-badge" class="badge badge-green">â— 30s ìë™ê°±ì‹ </span>
          <button class="btn btn-outline" onclick="loadDashboard()">ìƒˆë¡œê³ ì¹¨</button>
          <button class="btn btn-outline" onclick="showTab('history')">ì „ì²´ë³´ê¸° â†’</button>
        </div>
      </div>
      <div class="table-wrap">
        <table>
          <thead><tr><th>ì£¼ë¬¸ ID</th><th>ê³ ê°</th><th>ìƒí’ˆ</th><th>ê¸ˆì•¡</th><th>ìƒíƒœ</th><th>ì‹œê°„</th></tr></thead>
          <tbody id="dashboard-orders"><tr><td colspan="6" class="empty-cell">ë¡œë”© ì¤‘...</td></tr></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PRODUCTS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="page-products" class="page">
    <div class="section">
      <div class="section-header">
        <div class="section-title">ìƒí’ˆ ëª©ë¡</div>
        <button class="btn btn-outline" onclick="loadProducts()">ìƒˆë¡œê³ ì¹¨</button>
      </div>
      <div class="product-grid" id="product-grid">
        <div class="empty-cell">ë¡œë”© ì¤‘...</div>
      </div>
    </div>

    <div class="section">
      <div class="order-panel">
        <div class="section-title" style="margin-bottom:1rem">ì£¼ë¬¸ ìƒì„±</div>
        <div class="form-row">
          <div class="form-group">
            <label>ì„ íƒ ìƒí’ˆ</label>
            <input id="sel-product" readonly placeholder="â¬† ìœ„ì—ì„œ ìƒí’ˆì„ í´ë¦­í•˜ì„¸ìš”">
          </div>
          <div class="form-group" style="max-width:90px">
            <label>ìˆ˜ëŸ‰</label>
            <input id="order-qty" type="number" value="1" min="1" max="99">
          </div>
          <div class="form-group">
            <label>ì´ë©”ì¼</label>
            <input id="order-email" type="email" value="customer@demo.com">
          </div>
          <button class="btn btn-primary" onclick="placeOrder()">ì£¼ë¬¸í•˜ê¸° â†’</button>
        </div>
        <div id="order-result" class="order-result" style="display:none"></div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• HISTORY â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="page-history" class="page">
    <div class="section">
      <div class="section-header">
        <div class="section-title">ì£¼ë¬¸ ë‚´ì—­ (PostgreSQL 16)</div>
        <button class="btn btn-outline" onclick="loadHistory()">ìƒˆë¡œê³ ì¹¨</button>
      </div>
      <div class="table-wrap">
        <table>
          <thead><tr><th>ì£¼ë¬¸ ID</th><th>ì´ë©”ì¼</th><th>ìƒí’ˆ</th><th>ìˆ˜ëŸ‰</th><th>ê¸ˆì•¡</th><th>ìƒíƒœ</th><th>ì‹œê°„</th></tr></thead>
          <tbody id="history-tbody"><tr><td colspan="7" class="empty-cell">ë¡œë”© ì¤‘...</td></tr></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• INFRA â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="page-infra" class="page">
    <div class="section">
      <div class="section-title" style="margin-bottom:1rem">í´ëŸ¬ìŠ¤í„° êµ¬ì„± (5ëŒ€ VM)</div>
      <div class="node-grid">
        <div class="node-card">
          <div class="node-name" style="color:var(--accent)">ğŸ§  Brain</div>
          <div class="node-ip">192.168.174.10</div>
          <div style="margin:0.4rem 0"><span class="badge badge-blue">k3s Control Plane</span></div>
          <div class="svc-list">
            <div class="svc-item"><span>k3s server</span><span class="badge badge-green">active</span></div>
            <div class="svc-item"><span>Neo4j 5.17</span><span class="badge badge-green">active</span></div>
            <div class="svc-item"><span>Ollama llama2</span><span class="badge badge-green">active</span></div>
          </div>
        </div>
        <div class="node-card">
          <div class="node-name" style="color:var(--green)">ğŸ’ª Body</div>
          <div class="node-ip">192.168.174.20</div>
          <div style="margin:0.4rem 0"><span class="badge badge-green">k3s Worker #1</span></div>
          <div class="svc-list">
            <div class="svc-item"><span>k3s-agent</span><span class="badge badge-green">Ready</span></div>
            <div class="svc-item"><span>FastAPI Pod</span><span id="body-api" class="badge badge-yellow">í™•ì¸ì¤‘</span></div>
            <div class="svc-item"><span>Redis Pod</span><span class="badge badge-green">Running</span></div>
          </div>
        </div>
        <div class="node-card">
          <div class="node-name" style="color:var(--green)">ğŸ’ª Body2</div>
          <div class="node-ip">192.168.174.21</div>
          <div style="margin:0.4rem 0"><span class="badge badge-green">k3s Worker #2</span></div>
          <div class="svc-list">
            <div class="svc-item"><span>k3s-agent</span><span class="badge badge-green">Ready</span></div>
            <div class="svc-item"><span>FastAPI Pod</span><span class="badge badge-blue">ë¶„ì‚° ë°°í¬</span></div>
          </div>
        </div>
        <div class="node-card">
          <div class="node-name" style="color:var(--yellow)">ğŸ” Memory</div>
          <div class="node-ip">192.168.174.30</div>
          <div style="margin:0.4rem 0"><span class="badge badge-yellow">Monitoring</span></div>
          <div class="svc-list">
            <div class="svc-item"><span>PostgreSQL 16</span><span id="pg-badge" class="badge badge-yellow">í™•ì¸ì¤‘</span></div>
            <div class="svc-item"><span>pgvector 0.8.1</span><span class="badge badge-green">installed</span></div>
            <div class="svc-item"><span>Prometheus</span><span class="badge badge-green">active</span></div>
            <div class="svc-item"><span>Grafana</span><span class="badge badge-green">active</span></div>
          </div>
        </div>
        <div class="node-card">
          <div class="node-name" style="color:var(--purple)">ğŸ›¡ï¸ Shield</div>
          <div class="node-ip">192.168.174.40</div>
          <div style="margin:0.4rem 0"><span class="badge badge-purple">PQC Gateway</span></div>
          <div class="svc-list">
            <div class="svc-item"><span>liboqs</span><span class="badge badge-green">installed</span></div>
            <div class="svc-item"><span>Kyber-512</span><span class="badge badge-green">âœ“ verified</span></div>
          </div>
        </div>
      </div>
    </div>

    <div class="section" style="margin-top:1.5rem">
      <div class="section-title" style="margin-bottom:1rem">ì™¸ë¶€ ë§í¬</div>
      <div style="display:flex;gap:0.75rem;flex-wrap:wrap">
        <a href="http://192.168.174.30:3000" target="_blank" class="btn btn-outline">ğŸ“ˆ Grafana</a>
        <a href="http://192.168.174.30:9090" target="_blank" class="btn btn-outline">ğŸ” Prometheus</a>
        <a href="http://192.168.174.10:7474" target="_blank" class="btn btn-outline">ğŸ•¸ï¸ Neo4j Browser</a>
        <a href="http://192.168.174.20:30080/docs" target="_blank" class="btn btn-outline">ğŸ“„ FastAPI Swagger</a>
        <a href="http://192.168.174.20:30081" target="_blank" class="btn btn-outline">ğŸŒ k8s ëŒ€ì‹œë³´ë“œ</a>
      </div>
    </div>

    <div class="section" style="margin-top:1.5rem">
      <div class="section-title" style="margin-bottom:1rem">ë°ì´í„° íë¦„</div>
      <div class="flow-diagram">
        <div class="flow-node flow-blue">Browser<br><small>ì´ íŒŒì¼</small></div>
        <div class="flow-arrow">â†’</div>
        <div class="flow-node flow-green">FastAPI<br><small>:30080</small></div>
        <div class="flow-arrow">â†’</div>
        <div class="flow-node flow-yellow">PostgreSQL<br><small>ì£¼ë¬¸ ì €ì¥</small></div>
        <div class="flow-arrow">â†’</div>
        <div class="flow-node flow-purple">Neo4j<br><small>ê´€ê³„ ê¸°ë¡</small></div>
        <div class="flow-arrow">â†’</div>
        <div class="flow-node flow-red">Ollama<br><small>AI ë¶„ì„</small></div>
      </div>
    </div>
  </div>
</main>

<div id="toast"></div>
<script src="app.js"></script>
</body>
</html>
